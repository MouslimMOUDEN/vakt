uid: 1
actions:
  - Eq: fork
  - Eq: clone
resources:
  - StartsWith:
    - repos/Google
    - ci: True
subjects:
  - name: Any
    stars:
      - And:
        - Greater: 50
        - Less: 999
context:
  - referer:
    - Eq: https://github.com
effect: allow
description: >
  Allow to fork or clone any Google repository for users that
  have > 50 and < 999 stars and came from Github

---

# If there is no uid, all the subsequent policies in this list that do not have uid
# will be assigned an autoincremented integer uid (starting with 1)
actions:
  - Any:
  - Eq: fork
  - Eq: clone
resources:
  - StartsWith:
    - repos/Google
    - ci: true
  - Or:
    - Eq: bar
    - Eq: foo
subjects:
  - name: Any
    nick:
      - Eq: true
    city:
      - EndsWith:
        - don
        - ci: false
    stars:
      - And:
        - Greater: 50
        - Less: 999
context:
  - referer:
    - Eq: https://github.com
effect: deny

---

# You can define string-based policies as well.
uid: 3
actions:
  - '<read|get>'
resources:
  - 'library:books:<.+>'
  - 'office:magazines:<.+>'
subjects:
  - '<[\w]+ M[\w]+>'
effect: allow
description: >
  Allow all readers of the book library whose surnames start with M get and read any book or magazine,
  but only when they connect from local library's computer
