uid: 1
actions:
  - Eq: fork
  - Eq: clone
resources:
  - StartsWith:
    - repos/Google
    - ci: True
subjects:
  - name: Any
    stars:
      - And:
        - Greater: 50
        - Less: 999
context:
  - referer:
    - Eq: https://github.com
effect: allow
description: >
  Allow to fork or clone any Google repository for users that
  have > 50 and < 999 stars and came from Github

---

uid: auto
actions:
  - Eq: fork
  - Eq: clone
resources:
  - StartsWith:
    - repos/Google
    - ci: True
subjects:
  - name: Any
    stars:
      - And:
        - Greater: 50
        - Less: 999
context:
  - referer:
    - Eq: https://github.com
effect: deny
description: >
  Allow to fork or clone any Google repository for users that
  have > 50 and < 999 stars and came from Github


---

uid: 2
actions:
  - "<read|get>"
resources:
  - "library:books:<.+>"
  - "office:magazines:<.+>"
subjects:
  - "<[\w]+ M[\w]+>"
effect: allow
description: >
  Allow all readers of the book library whose surnames start with M get and read any book or magazine,
  but only when they connect from local library's computer
